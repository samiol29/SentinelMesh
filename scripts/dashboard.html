<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SENTINEL MESH | RL COMMAND</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0a0a0c; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(17, 24, 39, 0.7); backdrop-filter: blur(10px); }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-black tracking-tighter text-white">SENTINEL<span class="text-indigo-500">MESH</span></h1>
                <p class="text-xs text-gray-500 uppercase tracking-widest mt-1">Autonomous RL Routing Core V5.0</p>
            </div>
            <div class="text-right">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 bg-green-500 rounded-full pulse"></span>
                    <span class="text-[10px] font-bold text-green-500 uppercase">System Online</span>
                </div>
            </div>
        </header>

        <div id="leaderboard" class="grid grid-cols-3 gap-4 mb-8">
            </div>

        <div class="grid grid-cols-1 gap-6" id="feed">
            </div>
    </div>

    <script>
        const ws = new WebSocket(`ws://${window.location.host}/ws`);
        const feed = document.getElementById('feed');
        const leaderboard = document.getElementById('leaderboard');

        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            
            // 1. Update the Feed if it's a Resolution Card
            if (data.type === "resolution") {
                const card = document.createElement('div');
                card.innerHTML = data.html;
                feed.prepend(card);
            }

            // 2. Update the Leaderboard (The climbing scores)
            if (data.type === "stats") {
                leaderboard.innerHTML = Object.entries(data.scores).map(([name, score]) => {
                    let color = score > 70 ? 'text-green-400' : score > 40 ? 'text-yellow-400' : 'text-red-400';
                    let border = score > 70 ? 'border-green-500/30' : score > 40 ? 'border-yellow-500/30' : 'border-red-500/30';
                    return `
                        <div class="glass border ${border} p-3 rounded-lg">
                            <p class="text-[9px] uppercase font-bold text-gray-500">${name}</p>
                            <p class="text-xl font-mono font-black ${color}">${score}%</p>
                            <div class="w-full bg-gray-800 h-1 mt-2 rounded-full overflow-hidden">
                                <div class="bg-current h-full ${color}" style="width: ${score}%"></div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        };
    </script>
</body>
</html>
